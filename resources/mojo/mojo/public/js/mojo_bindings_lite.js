(function(){'use strict';var aa="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(a==Array.prototype||a==Object.prototype)return a;a[b]=c.value;return a};function ba(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}throw Error("Cannot find global object");}var ca=ba(this);
function da(a,b){if(b)a:{var c=ca;a=a.split(".");for(var e=0;e<a.length-1;e++){var d=a[e];if(!(d in c))break a;c=c[d]}a=a[a.length-1];e=c[a];b=b(e);b!=e&&null!=b&&aa(c,a,{configurable:!0,writable:!0,value:b})}}function ea(a){function b(e){return a.next(e)}function c(e){return a.throw(e)}return new Promise(function(e,d){function f(h){h.done?e(h.value):Promise.resolve(h.value).then(b,c).then(f,d)}f(a.next())})}
function fa(a,b){a instanceof String&&(a+="");var c=0,e=!1,d={next:function(){if(!e&&c<a.length){var f=c++;return{value:b(f,a[f]),done:!1}}e=!0;return{done:!0,value:void 0}}};d[Symbol.iterator]=function(){return d};return d}da("Array.prototype.values",function(a){return a?a:function(){return fa(this,function(b,c){return c})}});function k(a,b){a=a.split(".");let c=ha;for(let e;a.length&&(e=a.shift());)a.length||void 0===b?c[e]&&c[e]!=Object.prototype[e]?c=c[e]:c=c[e]={}:c[e]=b};var ha=self;k("mojo.internal.exportModule",function(a){let b=ha;a=a.split(".");for(let c;a.length&&(c=a.shift());)b[c]||(b[c]={}),b=b[c]});var l=!!(new Uint8Array((new Uint16Array([1])).buffer))[0];function n(a){return null===a||void 0===a}function q(a){return"undefined"!==typeof a.T}function r(a){return a+(8-a%8)%8}
function ia(a,b,c){l?(a.setUint32(b,Number(BigInt(c)&BigInt(4294967295)),l),a.setInt32(b+4,Number(BigInt(c)>>BigInt(32)&BigInt(4294967295)),l)):(a.setInt32(b,Number(BigInt(c)>>BigInt(32)&BigInt(4294967295)),l),a.setUint32(b+4,Number(BigInt(c)&BigInt(4294967295)),l))}
function t(a,b,c){l?(a.setUint32(b,Number(BigInt(c)&BigInt(4294967295)),l),a.setUint32(b+4,Number(BigInt(c)>>BigInt(32)&BigInt(4294967295)),l)):(a.setUint32(b,Number(BigInt(c)>>BigInt(32)&BigInt(4294967295)),l),a.setUint32(b+4,Number(BigInt(c)&BigInt(4294967295)),l))}function ja(a,b){let c;l?(c=a.getUint32(b,l),a=a.getUint32(b+4,l)):(c=a.getUint32(b+4,l),a=a.getUint32(b,l));return BigInt(a)<<BigInt(32)|BigInt(c)}
function ka(a,b){if(b.la)return b.la(a);if(a&&q(b)){const c=b.T,e=!n(a[c.originalFieldName]);return c.isPrimary?e:e?a[c.originalFieldName]:b.defaultValue}return a[b.name]}function la(a,b){let c=a.J,e=0;for(const d of a.B)a=ka(b,d),n(a)&&(a=d.defaultValue),null!==a&&(d.type.$.F?(a=d.type.$.F(a,d.S),c+=r(a.size),a.I&&(e+=a.I)):d.type.$.ca&&e++);return{size:c,I:e}}function ma(a,b){return a.m===u?8+w(a,b.length)+(b.length+7>>3):8+w(a,b.length)+b.length*a.m.$.j(!!a.C)}
function w(a,b){if(!a.C||!a.m.$.u)return 0;a=a.m.$.j(!0);const c=8*a;return((b+c-1)/c>>0)*a}function x(a,b){var c=ma(a,b);if(!a.m.$.F)return c;for(let e of b)n(e)||(c+=r(a.m.$.F(e,!!a.C).size));return c}function y(a,b){b=r(b);const c=new DataView(a.buffer,a.g,b);a.g+=b;return c}
var oa=class{constructor(a,b,c,e,d,f,h){const g=la(f,h);let m,p;0<g.I?(m=48,p=2):0==(c&3)?(m=24,p=0):(m=32,p=1);const H=m+g.size,Ja=0<g.I?8+4*g.I:0;this.buffer=new ArrayBuffer(H+r(Ja));this.handles=[];const v=new DataView(this.buffer);v.setUint32(0,m,l);v.setUint32(4,p,l);v.setUint32(8,b,l);v.setUint32(12,e,l);v.setUint32(16,c,l);v.setUint32(20,0);1<=p&&(t(v,24,d),2<=p&&(t(v,32,BigInt(16)),t(v,40,BigInt(H-40)),v.setUint32(H,Ja,l),v.setUint32(H+4,g.I||0,l)));this.i=0;this.h=null;g.I&&(this.h=new Uint32Array(this.buffer,
H+8,g.I));this.g=m;b=y(this,f.J);na(new z(this,b,{endpoint:a}),f,h)}};function pa(a){qa||(qa=new TextEncoder("utf-8"));return qa.encode(a)}
function na(a,b,c){var e=b.ha;A(a,0,b.J);A(a,4,e[e.length-1].version);for(const d of b.B){e=8+d.pa;const f=n(c)?void 0:ka(c,d);if(n(c)||n(f))if(null!==d.defaultValue)d.type.$.encode(d.defaultValue,a,e,d.fa,d.S);else if(d.S)d.type.$.o(a,e);else throw Error(b.name+' missing value for non-nullable field "'+d.name+`", got: "${f}"...`);else d.type.$.encode(f,a,e,d.fa,d.S)}}function B(a,b,c,e){const d=a.l.getUint8(b);e?a.l.setUint8(b,d|1<<c):a.l.setUint8(b,d&~(1<<c))}
function A(a,b,c){a.l.setUint32(b,c,l)}function ra(a,b,c){A(a,b,a.g.handles.length);a.g.handles.push(c)}function sa(a,b,c){console.assert(c.da,"expected unbound associated endpoint");var e=a.h.endpoint;console.assert(e.g,"cannot associate with unbound endpoint");const d=c.R;c.R=d.R=null;c=e.g;c=(c.ya++|c.wa)>>>0;d.g=e.g;d.i=c;d.h&&ta(e.g,d,c);e=a.g.i++;A(a,b,e);a.g.h[e]=c}
function C(a,b,c,e){const d=ma(b,e),f=y(a.g,d),h=new z(a.g,f,a.h);D(a,c,f.byteOffset);A(h,0,d);A(h,4,e.length);if(b.C&&b.m.$.u){a=0;c=8;for(var g of e)null===g||void 0===g?B(h,c,a,!1):B(h,c,a,!0),a++,8==a&&(a=0,c++)}g=8+w(b,e.length);if(b.m===u){b=0;for(const m of e)B(h,g,b,m),b++,8==b&&(b=0,g++)}else for(const m of e){if(null===m){if(!b.C)throw Error("Trying to send a null element in an array of non-nullable elements");b.m.$.o(h,g)}else b.m.$.encode(m,h,g,0,!!b.C);g+=b.m.$.j(!!b.C)}}
function D(a,b,c){t(a.l,b,c-a.l.byteOffset-b)}function ua(a,b,c,e){let d,f;"Map"==e.constructor.name?(d=Array.from(e.keys()),f=Array.from(e.values())):(d=Object.keys(e),f=d.map(m=>e[m]));const h=y(a.g,24),g=new z(a.g,h,a.h);D(a,c,h.byteOffset);A(g,0,24);A(g,4,0);C(g,{m:b.ea},8,d);C(g,{m:b.valueType,C:b.sa},16,f)}function va(a,b,c,e){const d=y(a.g,b.J),f=new z(a.g,d,a.h);D(a,c,d.byteOffset);na(f,b,e)}
function wa(a,b,c,e){var d=Object.keys(e);if(1!==d.length)throw Error(`Value for ${b.name} must be an Object with a `+"single property named one of: "+Object.keys(b.B).join(","));d=d[0];b=b.B[d];A(a,c,16);A(a,c+4,b.ordinal);c+=8;if("undefined"!==typeof b.type.$.U){b=b.type.$.U;e=e[d];d=y(a.g,16);const f=new z(a.g,d,a.h);D(a,c,d.byteOffset);wa(f,b,0,e)}else b.type.$.encode(e[d],a,c,0,b.nullable)}var z=class{constructor(a,b,c=null){this.h=c;this.g=a;this.l=b}},qa=null;
function xa(a,b,c){return!!(a.v.getUint8(b)&1<<c)}function E(a,b){return a.v.getUint32(b,l)}function ya(a,b){b=a.v.getUint32(b,l);if(4294967295==b)return null;if(b>=a.O.length)throw Error("Decoded invalid handle index");return a.O[b]}
function F(a,b,c){c=G(a,c);if(!c)return null;a=new I(new DataView(a.v.buffer,c),a.O,a.M);c=E(a,4);if(!c)return[];const e=!!b.C&&b.m.$.u,d=e?[]:null;if(e){var f=8,h=0;for(var g=0;g<c;++g)d.push(xa(a,f,h)),h++,8===h&&(h=0,f++)}f=8+w(b,c);h=[];if(b.m===u)for(b=0;b<c;++b)e&&!d[b]?h.push(null):h.push(xa(a,f+(b>>3),b%8));else for(g=0;g<c;++g){if(e&&!d[g])h.push(null);else{const m=b.m.$.decode(a,f,0,!!b.C);if(null===m&&!b.C)throw Error("Received unexpected array element");h.push(m)}f+=b.m.$.j(!!b.C)}return h}
function G(a,b){const c=ja(a.v,b);if(0==c)return 0;if(c>BigInt(Number.MAX_SAFE_INTEGER))throw Error("Mesage offset too large");return a.v.byteOffset+b+Number(c)}function J(a,b){var c=E(a,0);const e=E(a,4);if(!za(b,c,e))throw Error(`Received ${b.name} of invalid size (${c}) and/or `+`version (${e})`);c={};for(let d=0;d<b.B.length;++d){const f=b.B[d];if(q(f)){const h=f.T;h.isPrimary&&(c[h.originalFieldName]=Aa(a,f,b.B,e))}else c[f.name]=K(a,f,e)}return c}
function za(a,b,c){const e=a.ha;for(let d=e.length-1;0<=d;--d){const f=e[d];if(c>f.version)return b>=f.J;if(c==f.version)return b==f.J}throw Error(`Impossible version ${c} for struct ${a.name}`);}function Aa(a,b,c,e){if(b.oa>e||!K(a,b,e))return null;const d=b.T;b=c.find(f=>f.name===d.linkedValueFieldName);if(!b)throw Error("could not find the expected value field spec: "+d.linkedValueFieldName);return K(a,b,e)}
function K(a,b,c){if(b.oa>c)b=b.defaultValue;else{a=b.type.$.decode(a,8+b.pa,b.fa,!!b.S);if(null===a&&!b.S)throw Error(`Received ${b.name} with invalid null field `+`"${b.name}"`);b=a}return b}
function Ba(a,b,c){if(0===E(a,c))return null;var e=E(a,c+4);for(const d in b.B){const f=b.B[d];if(f.ordinal===e){e=c+8;"undefined"!==typeof f.type.$.U?(c=f.type.$.U,a=(e=G(a,e))?Ba(new I(new DataView(a.v.buffer,e),a.O,a.M),c,0):null):a=f.type.$.decode(a,e,0,f.nullable);if(null===a&&!f.nullable)throw Error(`Received ${b.name} with invalid null `+`field: ${f.name}`);b={};b[d]=a;return b}}}
function Ca(a,b){if(!a.M||!a.M.endpoint)throw Error("cannot deserialize associated endpoint without context");const c=a.M.endpoint;var e=new DataView(a.v.buffer);const d=Number(ja(e,40)),f=e.getUint32(d+44,l);e=new Uint32Array(e.buffer,d+48,f);a=E(a,b);return new L(c.H,e[a])}
var I=class{constructor(a,b,c=null){this.M=c;this.v=a;this.O=b}},Da=null,u={$:{encode:function(a,b,c,e){B(b,c,e,a)},o:function(){throw Error("encoding bool null from type is not implemented");},decode:function(a,b,c){return xa(a,b,c)},j:()=>1,s:!0,u:!0}};k("mojo.internal.Bool",u);k("mojo.internal.Int8",{$:{encode:function(a,b,c){b.l.setInt8(c,a)},o:function(a,b){a.l.setInt8(b,0)},decode:function(a,b){return a.v.getInt8(b)},j:()=>1,s:!0,u:!0}});
var M={$:{encode:function(a,b,c){b.l.setUint8(c,a)},o:function(a,b){a.l.setUint8(b,0)},decode:function(a,b){return a.v.getUint8(b)},j:()=>1,s:!0,u:!0}};k("mojo.internal.Uint8",M);k("mojo.internal.Int16",{$:{encode:function(a,b,c){b.l.setInt16(c,a,l)},o:function(a,b){a.l.setInt16(b,0,l)},decode:function(a,b){return a.v.getInt16(b,l)},j:()=>2,s:!0,u:!0}});
k("mojo.internal.Uint16",{$:{encode:function(a,b,c){b.l.setUint16(c,a,l)},o:function(a,b){a.l.setUint16(b,0,l)},decode:function(a,b){return a.v.getUint16(b,l)},j:()=>2,s:!0,u:!0}});k("mojo.internal.Int32",{$:{encode:function(a,b,c){b.l.setInt32(c,a,l)},o:function(a,b){a.l.setInt32(b,0,l)},decode:function(a,b){return a.v.getInt32(b,l)},j:()=>4,s:!0,u:!0}});var N={$:{encode:function(a,b,c){A(b,c,a)},o:function(a,b){A(a,b,0)},decode:function(a,b){return E(a,b)},j:()=>4,s:!0,u:!0}};
k("mojo.internal.Uint32",N);var Ea={$:{encode:function(a,b,c){ia(b.l,c,a)},o:function(a,b){ia(a.l,b,0)},decode:function(a,b){var c=a.v;l?(a=c.getUint32(b,l),b=c.getInt32(b+4,l)):(a=c.getUint32(b+4,l),b=c.getInt32(b,l));return BigInt(b)<<BigInt(32)|BigInt(a)},j:()=>8,s:!1,u:!0}};k("mojo.internal.Int64",Ea);k("mojo.internal.Uint64",{$:{encode:function(a,b,c){t(b.l,c,a)},o:function(a,b){t(a.l,b,0)},decode:function(a,b){return ja(a.v,b)},j:()=>8,s:!1,u:!0}});
k("mojo.internal.Float",{$:{encode:function(a,b,c){b.l.setFloat32(c,a,l)},o:function(a,b){a.l.setFloat32(b,0,l)},decode:function(a,b){return a.v.getFloat32(b,l)},j:()=>4,s:!0,u:!0}});k("mojo.internal.Double",{$:{encode:function(a,b,c){b.l.setFloat64(c,a,l)},o:function(a,b){a.l.setFloat64(b,0,l)},decode:function(a,b){return a.v.getFloat64(b,l)},j:()=>8,s:!0,u:!0}});var O={$:{encode:function(a,b,c){ra(b,c,a)},o:function(a,b){A(a,b,4294967295)},decode:function(a,b){return ya(a,b)},j:()=>4,s:!1,u:!1}};
k("mojo.internal.Handle",O);var Fa={$:{encode:function(a,b,c){if("string"!==typeof a)throw Error("Unxpected non-string value for string field.");C(b,{m:M},c,pa(a))},o:function(){},decode:function(a,b){(a=F(a,{m:M},b))?(Da||(Da=new TextDecoder("utf-8")),a=Da.decode((new Uint8Array(a)).buffer)):a=null;return a},F:function(a){return{size:x({m:M},pa(a))}},j:()=>8,s:!0,u:!1}};k("mojo.internal.String",Fa);
function Ga(a,b){const c={m:a,C:b};return{$:{Fa:c,encode:function(e,d,f){C(d,c,f,e)},o:function(){},decode:function(e,d){return F(e,c,d)},F:function(e){return{size:x(c,e)}},j:()=>8,s:!1,u:!1}}}k("mojo.internal.Array",Ga);
k("mojo.internal.Map",function(a,b,c){const e={ea:a,valueType:b,sa:c};return{$:{Ha:e,encode:function(d,f,h){ua(f,e,h,d)},o:function(){},decode:function(d,f){if(f=G(d,f)){f=new I(new DataView(d.v.buffer,f),d.O,d.M);d=E(f,0);var h=E(f,4);if(24!=d||0!=h)throw Error("Received invalid map data");d=F(f,{m:e.ea},8);f=F(f,{m:e.valueType,C:e.sa},16);if(d.length!=f.length)throw Error("Received invalid map data");if(e.ea.$.s){h={};for(var g=0;g<d.length;++g)h[d[g]]=f[g];d=h}else{h=new Map;for(g=0;g<d.length;++g)h.set(d[g],
f[g]);d=h}}else d=null;return d},F:function(d){const f="Map"==d.constructor.name?Array.from(d.keys()):Object.keys(d),h="Map"==d.constructor.name?Array.from(d.values()):f.map(g=>d[g]);return{size:24+r(x({m:a},f))+x({m:b,C:c},h)}},j:()=>8,s:!1,u:!1}}});function Ha(){return{$:{encode:function(a,b,c){A(b,c,a)},o:function(){},decode:function(a,b){return a.v.getInt32(b,l)},j:()=>4,s:!0,u:!0}}}k("mojo.internal.Enum",Ha);
function P(a,b,c,e,d,f,h=0,g,m){return{name:a,pa:b,fa:c,type:e,defaultValue:d,S:f,oa:h,T:g,la:m}}k("mojo.internal.StructField",P);function Q(a,b,c,e){e=e.map(f=>({version:f[0],J:f[1]}));const d={name:b,J:e[e.length-1].J,B:c,ha:e};a.$={K:d,encode:function(f,h,g){va(h,d,g,f)},o:function(){},decode:function(f,h){return(h=G(f,h))?J(new I(new DataView(f.v.buffer,h),f.O,f.M),d):null},F:function(f){return la(d,f)},j:()=>8,s:!1}}k("mojo.internal.Struct",Q);
k("mojo.internal.TypemappedStruct",function(a,b,c,e,d,f){f=f.map(g=>({version:g[0],J:g[1]}));const h={name:b,J:f[f.length-1].J,B:d,ha:f};a.$={K:h,encode:function(g,m,p){va(m,h,p,g)},o:function(){},decode:function(g,m){if(m=G(g,m)){g=new I(new DataView(g.v.buffer,m),g.O,g.M);m=E(g,0);var p=E(g,4);if(!za(h,m,p))throw Error(`Received ${h.name} of invalid size (${m}) and/or `+`version (${p})`);g=new c(g,p,h.B)}else g=null;return n(g)?null:e.convert(g)},F:function(g){return la(h,g)},j:()=>8,s:!1}});
k("mojo.internal.createStructDeserializer",function(a){return function(b){if(void 0==a.$||void 0==a.$.K)throw Error("Invalid struct mojom type!");return J(new I(b,[]),a.$.K)}});
function R(a,b,c){const e={name:b,B:c};a.$={U:e,encode:function(d,f,h){wa(f,e,h,d)},o:function(){},decode:function(d,f){return Ba(d,e,f)},F:function(d,f){f=f?16:0;let h=0;var g=Object.keys(d);if(1!==g.length)throw Error(`Value for ${e.name} must be an Object with a `+"single property named one of: "+Object.keys(e.B).join(","));const m=g[0];g=e.B[m];d=d[m];n(d)||(g.type.$.F?(d=g.type.$.F(d,!!g.type.$.U||g.nullable),f+=r(d.size),d.I&&(h+=d.I)):g.type.$.ca&&h++);return{size:f,I:h}},j:d=>d?8:16,s:!1}}
k("mojo.internal.Union",R);k("mojo.internal.InterfaceProxy",function(a){return{$:{encode:function(b,c,e){b=b.proxy.ra();console.assert(b,`unexpected null ${a.name}`);b=Ia(b);ra(c,e,b);A(c,e+4,0)},o:function(b,c){A(b,c,4294967295)},decode:function(b,c){return(b=ya(b,c))?new a(b):null},j:()=>8,s:!1,u:!1}}});
k("mojo.internal.InterfaceRequest",function(a){return{$:{encode:function(b,c,e){if(!b.handle)throw Error("Unexpected null "+a.name);ra(c,e,Ia(b.handle))},o:function(b,c){A(b,c,4294967295)},decode:function(b,c){return(b=ya(b,c))?new a(S(b)):null},j:()=>8,s:!1,u:!1}}});
k("mojo.internal.AssociatedInterfaceProxy",function(a){return{$:{type:a,encode:function(b,c,e){console.assert(b.proxy.endpoint&&b.proxy.endpoint.da,`expected ${a.name} to be associated and unbound`);sa(c,e,b.proxy.endpoint);A(c,e+4,0)},o:function(b,c){A(b,c,4294967295);A(b,c+4,0)},decode:function(b,c){return new a(Ca(b,c))},j:()=>{throw Error("Arrays of associated endpoints are not yet supported");},s:!1,ca:!0,u:!1}}});
k("mojo.internal.AssociatedInterfaceRequest",function(a){return{$:{type:a,encode:function(b,c,e){console.assert(b.handle&&b.handle.da,`expected ${a.name} to be associated and unbound`);sa(c,e,b.handle)},o:function(b,c){A(b,c,4294967295)},decode:function(b,c){return new a(Ca(b,c))},j:()=>{throw Error("Arrays of associated endpoints are not yet supported");},s:!1,ca:!0,u:!1}}});k("mojo.internal.decodeStructField",function(a,b,c){return K(a,b,c)});
k("mojo.internal.decodeStructNullableValueField",function(a,b,c,e){return Aa(a,b,c,e)});k("mojo.interfaceControl.RUN_MESSAGE_ID",4294967295);k("mojo.interfaceControl.RUN_OR_CLOSE_PIPE_MESSAGE_ID",4294967294);var Ka={$:{}};k("mojo.interfaceControl.RunMessageParamsSpec",Ka);var La={$:{}};k("mojo.interfaceControl.RunResponseMessageParamsSpec",La);var Ma={$:{}};k("mojo.interfaceControl.QueryVersionSpec",Ma);var Na={$:{}};k("mojo.interfaceControl.QueryVersionResultSpec",Na);var Oa={$:{}};k("mojo.interfaceControl.FlushForTestingSpec",Oa);var Pa={$:{}};
k("mojo.interfaceControl.RunOrClosePipeMessageParamsSpec",Pa);var Qa={$:{}};k("mojo.interfaceControl.RequireVersionSpec",Qa);var Ra={$:{}};k("mojo.interfaceControl.EnableIdleTrackingSpec",Ra);var Sa={$:{}};k("mojo.interfaceControl.MessageAckSpec",Sa);var Ta={$:{}};k("mojo.interfaceControl.NotifyIdleSpec",Ta);var Ua={$:{}};k("mojo.interfaceControl.RunInputSpec",Ua);var Va={$:{}};k("mojo.interfaceControl.RunOutputSpec",Va);var Wa={$:{}};k("mojo.interfaceControl.RunOrClosePipeInputSpec",Wa);
Q(Ka.$,"RunMessageParams",[P("input",0,0,Ua.$,null,!1,0)],[[0,24]]);Q(La.$,"RunResponseMessageParams",[P("output",0,0,Va.$,null,!0,0)],[[0,24]]);Q(Ma.$,"QueryVersion",[],[[0,8]]);Q(Na.$,"QueryVersionResult",[P("version",0,0,N,0,!1,0)],[[0,16]]);Q(Oa.$,"FlushForTesting",[],[[0,8]]);Q(Pa.$,"RunOrClosePipeMessageParams",[P("input",0,0,Wa.$,null,!1,0)],[[0,24]]);Q(Qa.$,"RequireVersion",[P("version",0,0,N,0,!1,0)],[[0,16]]);
Q(Ra.$,"EnableIdleTracking",[P("timeoutInMicroseconds",0,0,Ea,BigInt(0),!1,0)],[[0,16]]);Q(Sa.$,"MessageAck",[],[[0,8]]);Q(Ta.$,"NotifyIdle",[],[[0,8]]);R(Ua.$,"RunInput",{queryVersion:{ordinal:0,type:Ma.$},flushForTesting:{ordinal:1,type:Oa.$}});R(Va.$,"RunOutput",{queryVersionResult:{ordinal:0,type:Na.$}});R(Wa.$,"RunOrClosePipeInput",{requireVersion:{ordinal:0,type:Qa.$},enableIdleTracking:{ordinal:1,type:Ra.$},messageAck:{ordinal:2,type:Sa.$},notifyIdle:{ordinal:3,type:Ta.$}});var Xa={$:Ha()};k("mojo.native.SerializedHandleTypeSpec",Xa);k("mojo.native.SerializedHandleType",{Ca:0,Da:1,Ea:2,Ba:3,Aa:4,MIN_VALUE:0,MAX_VALUE:4});var Ya={$:{}};k("mojo.native.SerializedHandleSpec",Ya);var Za={$:{}};k("mojo.native.NativeStructSpec",Za);Q(Ya.$,"SerializedHandle",[P("theHandle",0,0,O,null,!1,0),P("type",4,0,Xa.$,0,!1,0)],[[0,16]]);Q(Za.$,"NativeStruct",[P("data",0,0,Ga(M,!1),null,!1,0),P("handles",8,0,Ga(Ya.$,!1),null,!0,0)],[[0,24]]);k("mojo.pipeControl.RUN_OR_CLOSE_PIPE_MESSAGE_ID",4294967294);var $a={$:{}};k("mojo.pipeControl.RunOrClosePipeMessageParamsSpec",$a);var ab={$:{}};k("mojo.pipeControl.DisconnectReasonSpec",ab);var bb={$:{}};k("mojo.pipeControl.PeerAssociatedEndpointClosedEventSpec",bb);var cb={$:{}};k("mojo.pipeControl.PauseUntilFlushCompletesSpec",cb);var db={$:{}};k("mojo.pipeControl.FlushAsyncSpec",db);var eb={$:{}};k("mojo.pipeControl.RunOrClosePipeInputSpec",eb);
Q($a.$,"RunOrClosePipeMessageParams",[P("input",0,0,eb.$,null,!1,0)],[[0,24]]);Q(ab.$,"DisconnectReason",[P("customReason",0,0,N,0,!1,0),P("description",8,0,Fa,null,!1,0)],[[0,24]]);Q(bb.$,"PeerAssociatedEndpointClosedEvent",[P("id",0,0,N,0,!1,0),P("disconnectReason",8,0,ab.$,null,!0,0)],[[0,24]]);Q(cb.$,"PauseUntilFlushCompletes",[P("flushPipe",0,0,O,null,!1,0)],[[0,16]]);Q(db.$,"FlushAsync",[P("flusherPipe",0,0,O,null,!1,0)],[[0,16]]);
R(eb.$,"RunOrClosePipeInput",{peerAssociatedEndpointClosedEvent:{ordinal:0,type:bb.$},pauseUntilFlushCompletes:{ordinal:1,type:cb.$},flushAsync:{ordinal:2,type:db.$}});function ta(a,b,c){0===c&&a.h.start();console.assert(null!==a.h.g,"adding a secondary endpoint with no primary");a.g.set(c,b)}
var ib=class{constructor(a,b){this.i=a;this.h=new fb(a);this.h.A=this.G.bind(this);this.h.i=this.A.bind(this);this.g=new Map;this.ya=1;this.wa=b?2147483648:0;this.aa=new gb(this,this.za.bind(this))}get H(){return this.i}close(){console.assert(0===this.g.size,"closing primary endpoint with secondary endpoints still bound");var a=this.h;a.g&&hb(a);a.h.close()}G(a,b){if(24>a.byteLength)console.error("Rejecting undersized message"),this.A();else{var c=new DataView(a);var e=c.getUint32(0,l),d=c.getUint32(4,
l);if(0==d&&24!=e||1==d&&32!=e||2<=d&&48>e)throw Error("Received invalid message header");c={Z:e,Ga:d,na:c.getUint32(8,l),L:c.getUint32(12,l),flags:c.getUint32(16,l),requestId:1>d?0:c.getUint32(24,l)};e=this.aa;4294967294!==c.L?e=!1:(d=new DataView(a,c.Z),d=J(new I(d,[]),$a.$.$.K).input,d.hasOwnProperty("peerAssociatedEndpointClosedEvent")&&e.h(d.peerAssociatedEndpointClosedEvent.id),e=!0);if(!e)if(e=this.g.get(c.na)){console.assert(e.h,"endpoint has no client");d=e.A;if(4294967295===c.L){var f=new DataView(a,
c.Z);const h=new I(f,[]);c.flags&1?(f=c.requestId,J(h,Ka.$.$.K).input.hasOwnProperty("flushForTesting")?(T(d.g,4294967295,f,2,La.$,{output:null}),d=!0):d=!1):(d=d.h.get(c.requestId))?(d(),d=!0):d=!1}else d=!1;d||e.h.G(e,c,a,b)}else console.error(`Received message for unknown endpoint ${c.na}`)}}A(){for(const a of this.g.values())a.h&&a.h.h(a);this.g.clear()}za(a){(a=this.g.get(a))&&a.h&&a.h.h(a)}};function jb(){const a=new L,b=new L;b.R=a;a.R=b;return{ja:a,ka:b}}
function Ia(a){console.assert(a.isPrimary(),"secondary endpoint cannot release pipe");return a.g.H}function kb(a){const b=a.G++;4294967295<a.G&&(a.G=0);return b}function T(a,b,c,e,d,f){b=new oa(a,a.i,e,b,c,d.$.K,f);console.assert(a.g,"cannot send message on unassociated unbound endpoint");a.g.i.writeMessage(b.buffer,b.handles)}function lb(a){if(a.g){var b=a.g,c=a.i;b.g.delete(c);0===c&&hb(b.h)}a.h=null;a.A=null}
var L=class{constructor(a=null,b=0){this.g=a;this.i=b;this.A=new mb(this);this.h=null;this.G=0;this.R=null}get H(){return this.g}isPrimary(){return null!==this.g&&0===this.i}get da(){return null!==this.R}start(a){console.assert(!this.h,"endpoint already started");this.h=a;this.g&&ta(this.g,this,this.i)}get aa(){return null!==this.h}close(){if(this.g){var a=this.H,b=this.i;a.g.delete(b);0===b&&hb(a.h);0===b?a.close():(a=a.aa,b=new oa(null,4294967295,0,4294967294,0,$a.$.$.K,{input:{peerAssociatedEndpointClosedEvent:{id:b}}}),
a.g.i.writeMessage(b.buffer,b.handles))}this.A=this.h=null}N(){const a=this;return ea(function*(){return nb(a.A)}())}};k("mojo.internal.interfaceSupport.acceptBufferForTesting",function(a,b){a.g.G(b,[])});function S(a,b=!1){return void 0===a.watch?a:new L(new ib(a,b),0)}k("mojo.internal.interfaceSupport.getEndpointForReceiver",function(a){return S(a)});
k("mojo.internal.interfaceSupport.bind",function(a,b,c){console.assert(a.isPrimary()&&null===a.g.h.g,"endpoint is either associated or already bound");Mojo.bindInterface(b,a.g.H,c)});var gb=class{constructor(a,b){this.g=a;this.h=b}};function nb(a){var b={flushForTesting:{}};const c=kb(a.g);return new Promise(e=>{T(a.g,4294967295,c,1,Ka.$,{input:b});a.h.set(c,e)})}var mb=class{constructor(a){this.g=a;this.h=new Map}};function ob(a){for(const b of a.g.values())b()}
var U=class{constructor(){this.g=new Map;this.h=0}addListener(a){const b=++this.h;this.g.set(b,a);return b}removeListener(a){return this.g.delete(a)}};k("mojo.internal.interfaceSupport.ConnectionErrorEventRouter",U);U.prototype.removeListener=U.prototype.removeListener;U.prototype.addListener=U.prototype.addListener;k("mojo.internal.interfaceSupport.PendingReceiver",class{get handle(){}});function pb(a,b){a.g&&lb(a.g);for(const c of a.i.keys())a.i.get(c).reject(Error(b));a.i=new Map}
var V=class{constructor(a,b){this.g=null;this.H=a;this.i=new Map;this.A=new U;b&&this.D(b)}get endpoint(){return this.g}X(){let {handle0:a,handle1:b}=Mojo.createMessagePipe();this.D(a);return new this.H(S(b))}D(a){console.assert(!this.g,"already bound");this.g=a=S(a,!0);this.g.start(this);this.i=new Map}V(){console.assert(!this.g,"cannot associate when already bound");const {ja:a,ka:b}=jb();this.D(a);return new this.H(b)}ra(){if(!this.g)return null;const a=this.g;this.g=null;lb(a);return a}close(){pb(this,
"Message pipe closed.");this.g&&this.g.close();this.g=null}ba(){return this.A}xa(a,b,c,e,d){if(c&&(!this.g||!this.g.aa))return Promise.reject(Error("The pipe has already been closed."));const f={};let h=0;b.$.K.B.forEach((m,p)=>{p-=h;q(m)?(m=m.T,m.isPrimary&&(h++,f[m.originalFieldName]=e[p])):f[m.name]=e[p]});const g=kb(this.g);T(this.g,a,g,c?1:0,b,f);return c?new Promise((m,p)=>{this.i.set(g,{requestId:g,L:a,P:c,resolve:m,reject:p,ga:d})}):Promise.resolve()}N(){return this.g.N()}G(a,b,c,e){if(!(b.flags&
2)||b.flags&1)this.h(a,"Received unexpected request message");else{var d=this.i.get(b.requestId);this.i.delete(b.requestId);d?(c=J(new I(new DataView(c,b.Z),e,{endpoint:a}),d.P.$.K))&&b.L===d.L?d.ga?(a=c.result,void 0!==a.success?d.resolve(a.success):d.reject(a.failure)):d.resolve(c):this.h(a,"Received malformed response message"):this.h(a,"Received unexpected response message")}}h(a,b){pb(this,b);ob(this.A)}};k("mojo.internal.interfaceSupport.InterfaceRemoteBase",V);V.prototype.flushForTesting=V.prototype.N;
V.prototype.sendMessage=V.prototype.xa;V.prototype.getConnectionErrorEventRouter=V.prototype.ba;V.prototype.close=V.prototype.close;V.prototype.unbind=V.prototype.ra;V.prototype.associateAndPassReceiver=V.prototype.V;V.prototype.bindHandle=V.prototype.D;var W=class{constructor(a){this.g=a}X(){return this.g.X()}V(){return this.g.V()}ua(){return null!==this.g.g}close(){this.g.close()}N(){return this.g.N()}};k("mojo.internal.interfaceSupport.InterfaceRemoteBaseWrapper",W);
W.prototype.flushForTesting=W.prototype.N;W.prototype.close=W.prototype.close;W.prototype.isBound=W.prototype.ua;W.prototype.associateAndPassReceiver=W.prototype.V;W.prototype.bindNewPipeAndPassReceiver=W.prototype.X;var qb=class{constructor(){this.g=new Map;this.h=0}removeListener(a){this.g.get(a)();return this.g.delete(a)}};k("mojo.internal.interfaceSupport.CallbackRouter",qb);qb.prototype.removeListener=qb.prototype.removeListener;
var X=class{constructor(a){this.g=new Map;this.h=a}addListener(a){const b=++this.h.h;this.g.set(b,a);this.h.g.set(b,()=>this.g.delete(b));return b}ta(a){return a?this.i.bind(this):this.A.bind(this)}A(a){const b=Array.from(arguments);this.g.forEach(c=>c.apply(null,b))}i(a){const b=Array.from(arguments),c=Array.from(this.g.values()).map(d=>d.apply(null,b));let e;for(const d of c)if(void 0!==d){if(void 0!==e)throw Error("Multiple listeners attempted to reply to a message");e=d}return e}};
k("mojo.internal.interfaceSupport.InterfaceCallbackReceiver",X);X.prototype.createReceiverHandler=X.prototype.ta;X.prototype.addListener=X.prototype.addListener;function rb(a,b,c,e){try{let d=c.ma.apply(null,e);if("object"!=typeof d||"Promise"!=d.constructor.name)d=Promise.resolve(d);d.then(f=>{T(a,b.L,b.requestId,2,c.P,{result:{success:f}})}).catch(f=>{T(a,b.L,b.requestId,2,c.P,{result:{failure:f}})})}catch(d){T(a,b.L,b.requestId,2,c.P,{result:{failure:d}})}}
function sb(a,b,c,e,d){d=e.ma.apply(null,d);if(e.P){if(void 0===d)throw a.h(b),Error("Message expects a reply but its handler did not provide one.");if("object"!=typeof d||"Promise"!=d.constructor.name)d=Promise.resolve(d);d.then(f=>{T(b,c.L,c.requestId,2,e.P,f)}).catch(()=>{a.h(b)})}}
var Y=class{constructor(a){this.g=new Set;this.H=a;this.A=new Map;this.i=new U}va(a,b,c,e,d){this.A.set(a,{qa:b,P:c,ma:e,ga:d})}D(a){a=S(a);this.g.add(a);a.start(this)}Y(){let a=new this.H;this.D(a.$.X().handle);return a}W(){const {ja:a,ka:b}=jb();this.D(a);return new this.H(b)}ia(){for(const a of this.g)a.close();this.g.clear()}ba(){return this.i}flush(){const a=this;return ea(function*(){for(let b of a.g)yield b.N()}())}G(a,b,c,e){if(b.flags&2)throw Error("Received unexpected response on interface receiver");
const d=this.A.get(b.L);if(!d)throw Error("Received unknown message");c=J(new I(new DataView(c,b.Z),e,{endpoint:a}),d.qa.$.K);if(!c)throw Error("Received malformed message");e=[];for(const f of d.qa.$.K.B){if(!q(f)){e.push(c[f.name]);continue}const h=f.T;h.isPrimary&&e.push(c[h.originalFieldName])}d.ga?rb(a,b,d,e):sb(this,a,b,d,e)}h(a){this.g.delete(a);a.close();ob(this.i)}};k("mojo.internal.interfaceSupport.InterfaceReceiverHelperInternal",Y);Y.prototype.flush=Y.prototype.flush;
Y.prototype.getConnectionErrorEventRouter=Y.prototype.ba;Y.prototype.closeBindings=Y.prototype.ia;Y.prototype.associateAndPassRemote=Y.prototype.W;Y.prototype.bindNewPipeAndPassRemote=Y.prototype.Y;Y.prototype.bindHandle=Y.prototype.D;Y.prototype.registerHandler=Y.prototype.va;var Z=class{constructor(a){this.g=a}D(a){this.g.D(a)}Y(){return this.g.Y()}W(){return this.g.W()}close(){this.g.ia()}flush(){return this.g.flush()}};k("mojo.internal.interfaceSupport.InterfaceReceiverHelper",Z);
Z.prototype.flush=Z.prototype.flush;Z.prototype.close=Z.prototype.close;Z.prototype.associateAndPassRemote=Z.prototype.W;Z.prototype.bindNewPipeAndPassRemote=Z.prototype.Y;Z.prototype.bindHandle=Z.prototype.D;function hb(a){a.g&&(a.g.cancel(),a.g=null)}
var fb=class{constructor(a){this.h=a;this.A=null;this.i=()=>{};this.g=null}start(){this.g=this.h.watch({readable:!0},this.G.bind(this))}G(){for(;this.g;){const a=this.h.readMessage();if(a.result==Mojo.RESULT_SHOULD_WAIT)break;if(a.result==Mojo.RESULT_FAILED_PRECONDITION){this.i();break}if(a.result!=Mojo.RESULT_OK)throw Error("Unexpected error on HandleReader: "+a.result);this.A(a.buffer,a.handles)}}};}).call(this);
